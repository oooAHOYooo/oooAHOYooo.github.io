<!DOCTYPE html>
<html lang="en"
    x-data="{ step: 1, plan: '', username: '', sms: false, games: [] }">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Create an Account</title>
        <link rel="stylesheet" href="profile.css">
        <link
            href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap"
            rel="stylesheet">
        <link
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
            rel="stylesheet">

        <script
            src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"
            defer></script>
        <script src="https://js.squareup.com/v2/paymentform"></script>
        <script
            src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

        <!-- Firebase SDK -->
        <script
            src="https://www.gstatic.com/firebasejs/10.0.0/firebase-app.js"></script>
        <script
            src="https://www.gstatic.com/firebasejs/10.0.0/firebase-firestore.js"></script>
    </head>
    <body>
        <header>
            <img src="./img/assets/u_ahoy23.png" alt="Ahoy Logo">
        </header>

        <div class="wizard" x-show="step < 8">
            <!-- Step 1: Choose Membership Plan -->
            <template x-if="step === 1">
                <div>
                    <h1>Step 1: Choose Your Membership</h1>
                    <p>Select your desired membership plan:</p>
                    <label>
                        <input type="radio" x-model="plan" value="basic">
                        <strong>Basic Plan</strong> (Free - Every two weeks)
                        <br>
                        <a
                            href="https://checkout.square.site/merchant/MLCEJBSG4Z671/checkout/CD6UKUXBV4CZBBWNWS4MOFC4"
                            target="_blank">
                            View Details
                        </a>
                    </label>

                    <label>
                        <input type="radio" x-model="plan" value="supporter">
                        <strong>Supporter Plan</strong> ($1/week) <br>
                        <a
                            href="https://checkout.square.site/merchant/MLCEJBSG4Z671/checkout/7RFEZ5IN445HRRV3X2KZGS4P"
                            target="_blank">
                            View Details
                        </a>
                    </label>

                    <label>
                        <input type="radio" x-model="plan" value="super">
                        <strong>Super Supporter</strong> ($10/month) <br>
                        <a
                            href="https://checkout.square.site/merchant/MLCEJBSG4Z671/checkout/CD6UKUXBV4CZBBWNWS4MOFC4"
                            target="_blank">
                            View Details
                        </a>
                    </label>

                    <button
                        @click="plan ? step = 2 : alert('Please select a plan')">Next</button>
                </div>
            </template>

            <!-- Step 2: Personal Info -->
            <template x-if="step === 2">
                <div>
                    <h1>Step 2: Personal Info</h1>
                    <input type="text" placeholder="Full Name"
                        x-model="fullName">
                    <input type="email" placeholder="Email" x-model="email">
                    <button @click="step = 3"
                        :disabled="!fullName || !email">Next</button>
                    <button class="back-button" @click="step = 1">Back</button>
                </div>
            </template>

            <!-- Step 3: Payment Process -->
            <template x-if="step === 3">
                <div>
                    <h1>Step 3: Payment</h1>
                    <p>Proceed to Square's secure checkout or skip for now.</p>
                    <button @click="startPayment(plan)">Proceed to
                        Payment</button>
                    <button @click="step = 4">Skip Payment</button>
                    <button class="back-button" @click="step = 2">Back</button>
                </div>
            </template>

            <!-- Step 4: Success -->
            <template x-if="step === 4">
                <div>
                    <h1>Success!</h1>
                    <p>Your account has been created successfully. Welcome
                        aboard!</p>
                    <button @click="step = 5">See Features</button>
                </div>
            </template>

            <!-- Step 5: Customize Experience -->
            <template x-if="step === 5">
                <div>
                    <h1>Customize Your Experience</h1>
                    <label>Username:</label>
                    <input type="text" x-model="username">
                    <label>Enable SMS Notifications:</label>
                    <input type="checkbox" x-model="sms">
                    <label>Select Games:</label>
                    <select x-model="games" multiple>
                        <option value="game1">Game 1</option>
                        <option value="game2">Game 2</option>
                        <option value="game3">Game 3</option>
                    </select>
                    <button @click="saveUserData(username, email, plan)">Save
                        Profile</button>
                </div>
            </template>
        </div>

        <footer>
            <p>Powered by Ahoy - Secure and Trusted</p>
        </footer>

        <script src="js/fire/firebase-config.js"></script>
        <script src="js/fire/firestore.js"></script>
        <script src="js/fire/square-payment.js"></script>

        <script>
            function startPayment(plan) {
                if (plan) {
                    // Existing payment logic
                } else {
                    alert('Please select a plan');
                }
            }

            function saveUserData(username, email, plan) {
                // Logic to save user data to Firestore
                // Ensure this works without payment details
            }
        </script>
    </body>
</html>
