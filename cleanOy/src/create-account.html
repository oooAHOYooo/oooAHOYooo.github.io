<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Sign Up - Ahoy Indie Media</title>
    <link rel="stylesheet" href="./foundational.css" />
    <style>
      body {
        background: url("https://i.gifer.com/RzdU.gif") no-repeat center center
          fixed;
        -webkit-background-size: cover;
        -moz-background-size: cover;
        -o-background-size: cover;
        background-size: cover;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        height: 90vh;
      }
      .text-outline {
        color: black;
        text-shadow: -1px 0 white, 0 1px white, 1px 0 white, 0 -1px white;
      }
      body img {
        width: 300px;
        height: auto;
      }
      #signup-form {
        background: rgba(255, 255, 255, 0.1);
        border-radius: 10px;
        padding: 20px;
        width: 300px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        backdrop-filter: blur(10px);
      }
      #signup-form input,
      #signup-form button {
        width: 100%;
        padding: 10px;
        margin-top: 10px;
        margin-bottom: 10px;
        border: none;
        border-radius: 5px;
      }
      #signup-form button {
        background: dodgerblue;
        color: white;
      }
      #notification {
        color: red;
        margin-top: 10px;
      }
    </style>
  </head>
  <body>
    <a href="../index.html"><img src="../assets/u_ahoy23.png" /></a>
    <h1>Create an Account for Ahoy Indie Media</h1>
    <form id="signup-form">
      <input type="email" id="email" placeholder="Email" required />
      <input type="password" id="password" placeholder="Password" required />

      <h3>Choose Your Plan:</h3>
      <div>
        <input type="radio" id="free" name="plan" value="free" checked />
        <label for="free">Free Plan</label>
      </div>
      <div>
        <input type="radio" id="basic" name="plan" value="basic" />
        <label for="basic">$5/Month Basic Plan</label>
      </div>
      <div>
        <input type="radio" id="premium" name="plan" value="premium" />
        <label for="premium">$10/Month Premium Plan</label>
      </div>

      <button type="submit">Sign Up</button>
      <div id="notification"></div>
      <br />
      <a href="login.html" class="theme-link" id="loginLink"
        >Already Have an account? Login Baby</a
      >
    </form>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js/dist/supabase.min.js"></script>
    <script>
      // Initialize Supabase client
      const supabaseUrl = "https://ornjxycoizoybvdhhowp.supabase.co";
      const supabaseAnonKey =
        "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9ybmp4eWNvaXpveWJ2ZGhob3dwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MDIzNTA4ODEsImV4cCI6MjAxNzkyNjg4MX0.SIgYEybVeKQ5xGnplA-elTOw0oC5tZIv5nGRUZf-vS8";
      const supabase = Supabase.createClient(supabaseUrl, supabaseAnonKey);

      document
        .getElementById("signup-form")
        .addEventListener("submit", async (e) => {
          e.preventDefault();

          // Retrieve user input
          const email = document.getElementById("email").value;
          const password = document.getElementById("password").value;
          const plan = document.querySelector(
            'input[name="plan"]:checked'
          ).value;

          // Reference to the notification element
          const notificationEl = document.getElementById("notification");

          try {
            // Attempt to create a new user
            const { user, error } = await supabase.auth.signUp({
              email,
              password,
            });

            if (error) throw error;

            // Update the notification element on success
            notificationEl.textContent =
              "Signup successful! Please check your email for a confirmation link.";
            notificationEl.style.color = "green";
          } catch (error) {
            // Update the notification element on failure
            notificationEl.textContent = `Signup failed: ${error.message}`;
            notificationEl.style.color = "red";
          }
        });
    </script>
  </body>
</html>
