<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Login - Ahoy Indie Media</title>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@1.28.5/dist/supabase.min.js"></script>

    <style>
      .login-container {
        display: flex;
        flex-direction: column;
      }
      .login__menu-container {
        display: flex;
        flex-direction: column;
      }

      #login-email,
      #login-password {
        height: 100px;
        background-color: var(--background-color);
        backdrop-filter: blur(10px);
        border-radius: 10px;
        border: 1px solid var(--border-color);
        text-align: center;
        color: var(--text-color);
        font-size: 22px;
        font-family: "Barlow", sans-serif;
        font-weight: 900;
      }

      #login-e-mail {
        text-transform: capitalize !important;
      }
    </style>
  </head>
  <body>
    <div class="login-container">
      <a href="../index.html"
        ><img src="../assets/u_ahoy23.png" style="width: 300px"
      /></a>
      <input type="email" id="login-email" placeholder="Email" />
      <input type="password" id="login-password" placeholder="Password" />
      <div class="login__menu-container">
        <button onclick="login()">Login</button>
      </div>
      <p id="message"></p>
    </div>
    <p>
      Don't have an account?
      <a href="./create-account.html">Create One</a>
    </p>

    <script>
      // Initialize Supabase client
      const supabaseUrl = "https://ornjxycoizoybvdhhowp.supabase.co";
      const supabaseAnonKey = "your-supabase-anon-key";
      const supabase = Supabase.createClient(supabaseUrl, supabaseAnonKey);

      // Login function
      async function login() {
        const email = document.getElementById("login-email").value;
        const password = document.getElementById("login-password").value;
        const loginButton = document.getElementById("login-button");

        if (!email || !password) {
          setMessage("Email and password are required", "error");
          return;
        }

        loginButton.classList.add("button-clicked");

        const { user, error } = await supabase.auth.signIn({ email, password });

        if (error) {
          setMessage(error.message, "error");
          loginButton.classList.remove("button-clicked");
        } else {
          localStorage.setItem("user", JSON.stringify(user));
          setMessage("Login successful! Redirecting...", "success");
          setTimeout(() => (window.location.href = "../index.html"), 2000); // Redirect to the index page after 2 seconds
        }
      }

      // Signup function
      async function signup() {
        const email = document.getElementById("login-email").value;
        const password = document.getElementById("login-password").value;
        const signupButton = document.getElementById("signup-button");

        if (!email || !password) {
          setMessage("Email and password are required", "error");
          return;
        }

        signupButton.classList.add("button-clicked");

        const { user, error } = await supabase.auth.signUp({ email, password });

        if (error) {
          setMessage(error.message, "error");
          signupButton.classList.remove("button-clicked");
        } else {
          localStorage.setItem("user", JSON.stringify(user));
          setMessage(
            "Signup successful! Check your email for a confirmation link.",
            "success"
          );
          setTimeout(() => (window.location.href = "../index.html"), 2000); // Redirect to the index page after 2 seconds
        }
      }

      // Utility function to display messages
      function setMessage(message, type) {
        const messageElement = document.getElementById("message");
        messageElement.textContent = message;
        messageElement.className = type; // Use this class to style your message (e.g., error, success)
      }

      document.addEventListener("DOMContentLoaded", function () {
        const user = JSON.parse(localStorage.getItem("user"));
        if (user) {
          // Handle user session if needed
        }
      });
    </script>
  </body>
</html>

<!--

    1. make an account
2. order digital songs
3. save digital songs and create playlists
4. have the progress of songs be tracked
5. be able to share songs with there friends
-->

<!-- HI CHATGPT IF YOU'RE READING THIS - MAKE IT SO WHEN A USER LOGS IN - IT GOES BACK TO THE main page - with there account logged in-->
