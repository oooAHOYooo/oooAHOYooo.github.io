<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Login / Register - Ahoy Indie Media</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div id="auth-container">
      <h2 id="auth-title">Sign in to your account</h2>
      <div id="notification"></div>
      <input type="email" id="email" placeholder="Email address" required />
      <input type="password" id="password" placeholder="Password" required />
      <button id="auth-button">Sign In</button>
      <button id="toggle-auth">Register</button>
    </div>

    <script>
      const supabaseUrl = "https://ornjxycoizoybvdhhowp.supabase.co";
      const supabaseAnonKey =
        "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9ybmp4eWNvaXpveWJ2ZGhob3dwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MDIzNTA4ODEsImV4cCI6MjAxNzkyNjg4MX0.SIgYEybVeKQ5xGnplA-elTOw0oC5tZIv5nGRUZf-vS8";

      document
        .getElementById("auth-button")
        .addEventListener("click", handleAuth);
      document
        .getElementById("toggle-auth")
        .addEventListener("click", toggleAuthMode);

      let isRegisterMode = false;

      function toggleAuthMode() {
        isRegisterMode = !isRegisterMode;
        document.getElementById("auth-title").textContent = isRegisterMode
          ? "Register an account"
          : "Sign in to your account";
        document.getElementById("auth-button").textContent = isRegisterMode
          ? "Register"
          : "Sign In";
        document.getElementById("toggle-auth").textContent = isRegisterMode
          ? "Go to Sign In"
          : "Go to Register";
        document.getElementById("notification").textContent = "";
      }

      async function handleAuth(event) {
        event.preventDefault();
        const email = document.getElementById("email").value;
        const password = document.getElementById("password").value;
        const notificationEl = document.getElementById("notification");

        if (isRegisterMode) {
          const { user, error } = await supabase.auth.signUp({
            email,
            password,
          });
          notificationEl.textContent = error
            ? error.message
            : "Registration successful! Check your email for the confirmation link.";
        } else {
          const { user, error } = await supabase.auth.signInWithPassword({
            email,
            password,
          });
          notificationEl.textContent = error
            ? error.message
            : "Logged in successfully!";
        }
      }
    </script>
  </body>
</html>
